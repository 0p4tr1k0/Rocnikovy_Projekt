<html>
  <head>
    <title>ESP32-CAM Robot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
    body{
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      background-color: #000000;
    }
    h1{
      text-align: center;
      color: #00FF00;
    }
      img {
        width: auto;
        max-width: 100%;
        height: auto; 
      }

    .center {
    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    }
    .tlacitko{
width: 80px;
height: 40px;
}
.divCenter{
    text-align: center;
}
    </style>
  </head>
  <body>
    <h1>Robot</h1>
    <img src="" id="stream" class="center">
    <div class="divCenter">
      <button type="button" class="tlacitko w" onmousedown="goFnc('rovne');" ontouchstart="goFnc('rovne');" onclick="goFnc('rovne');" onmouseup="goFnc('stop');" ontouchend="goFnc('stop');">W</button>
      <br>
      <button type="button" class="tlacitko" onmousedown="goFnc('vlevo');" ontouchstart="goFnc('vlevo');" onclick="goFnc('vlevo');" onmouseup="goFnc('stop');" ontouchend="goFnc('stop');">A</button>
      <button type="button" class="tlacitko" onmousedown="goFnc('dozadu');" ontouchstart="goFnc('dozadu');" onclick="goFnc('dozadu');" onmouseup="goFnc('stop');" ontouchend="goFnc('stop');">S</button>
      <button type="button" class="tlacitko" onmousedown="goFnc('vpravo');" ontouchstart="goFnc('vpravo');" onclick="goFnc('vpravo');" onmouseup="goFnc('stop');" ontouchend="goFnc('stop');">D</button>
      <br>
      <button type="button" onclick="svetlo()">SvÄ›tlo</button>
  </div>
   <script>
    let led = false;
   window.onload = document.getElementById("stream").src = window.location.href.slice(0, -1) + ":81/stream";
   function goFnc(x){
    let xhr = new XMLHttpRequest();
    xhr.open ("GET", "/go?direction=" + x, true);
    xhr.send();
   }
   function svetlo(){
    let xhr = new XMLHttpRequest();
    if(led){
    xhr.open ("GET", "/go?direction=ledOff", true);
    led = false;
    } else{
      xhr.open ("GET", "/go?direction=ledOn", true);
      led = true;
    }
    xhr.send();
   }

    let lastKey;
    window.addEventListener('keydown', function (e) {
	    if(lastKey != e.key) {
        if(e.key == "w") {
          goFnc('rovne');
        }else if (e.key == "d") {
    	    goFnc('vlevo');
        }else if (e.key == "s") {
    	    goFnc('dozadu');
        }else if (e.key == "a") {
    	    goFnc('vpravo');
        }else if (e.key == "f") {
    	    svetlo();
        }
  	    lastKey = e.key;
      } 
    });

window.addEventListener("keyup", function(e) {
  if(e.key != "f"){
    goFnc('stop');
  }
    lastKey = "";
  });
  </script>
  </body>
</html>